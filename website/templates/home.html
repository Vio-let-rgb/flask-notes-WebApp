{% extends "base.html" %}
{% block title %}Home{% endblock %}

{% block content %}
<h1 align="center">Notes</h1>

<!-- Flash Messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<!-- Add Note Form -->
<form method="POST">
  <textarea name="note" id="note" class="form-control" placeholder="Write a note..." required></textarea>
  <br>
  <div align="center" class="mt-3">
    <button type="submit" class="btn btn-primary">Add Note</button>
  </div>
</form>

<hr>

<!-- Notes List -->
<ul class="list-group list-group-flush mt-4" id="notes">
  {% for note in user.notes %}
    <li class="list-group-item d-flex justify-content-between align-items-center">
      {{ note.data }}
      <button type="button" class="btn btn-danger btn-sm" onclick="deleteNote('{{ note.id }}')">

        &times;
      </button>
    </li>
  {% endfor %}
</ul>

<!-- Delete Note Script -->
<script>
  function deleteNote(noteId) {
    fetch("/delete-note", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ noteId: noteId })
    }).then((_res) => {
      window.location.href = "/";
    });
  }
</script>
{% endblock %}
